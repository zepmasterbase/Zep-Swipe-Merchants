<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zep Swipe â€” Merchant Dashboard</title>

<!-- Tailwind -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;700&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">

<!-- Ethers -->
<script src="https://cdn.jsdelivr.net/npm/ethers@6.6.0/dist/ethers.min.js"></script>

<style>
body {
  font-family: "Poppins", sans-serif;
  background: radial-gradient(circle at 20% 20%, #050016, #000010, #0a001c);
  color: #fff;
  min-height: 100vh;
  padding-bottom: 4rem;
}
.card {
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.16);
  backdrop-filter: blur(18px);
  border-radius: 1.2rem;
  padding: 1.4rem;
  box-shadow: 0 0 22px rgba(0,240,255,0.15);
}
.neon-text {
  font-family: Orbitron;
  background: linear-gradient(90deg,#00f0ff,#9c4dff);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}
.nav-btn {
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(255,255,255,0.18);
  border-radius: 12px;
  padding: 10px;
  text-align: center;
}
.nav-btn:hover {
  background: linear-gradient(90deg,#00f0ff33,#9c4dff33);
  transform: scale(1.02);
}
</style>
</head>

<body>

<!-- Header -->
<div class="flex justify-between items-center px-5 py-4">
  <h1 class="text-2xl neon-text font-bold">Zep Swipe Merchant</h1>

  <button onclick="logout()" class="text-red-300 hover:text-red-500 text-sm">
    Logout
  </button>
</div>

<!-- Wallet + Balance -->
<div class="px-5">
  <div class="card mb-5">
    <p class="text-sm text-cyan-300">Connected Wallet</p>
    <p id="walletDisplay" class="font-semibold mt-1"></p>

    <div class="mt-4">
      <p class="text-sm text-cyan-300">Your ZAC Balance</p>
      <h2 id="zacBalance" class="text-3xl mt-1 font-bold">0</h2>
    </div>
  </div>
</div>

<!-- Dashboard Grid -->
<div class="grid grid-cols-2 gap-4 px-5">

  <div class="card">
    <h3 class="neon-text text-lg mb-2">Sales Overview</h3>
    <p id="salesToday" class="text-xl font-bold">â‚µ0</p>
    <p class="text-sm text-cyan-300">Today</p>
  </div>

  <div class="card">
    <h3 class="neon-text text-lg mb-2">Daily Visitors</h3>
    <p id="visitors" class="text-xl font-bold">0</p>
    <p class="text-sm text-cyan-300">Today</p>
  </div>

  <a href="listing.html" class="nav-btn">
    <p>ðŸ“¦ Add Products</p>
  </a>

  <a href="wallet.html" class="nav-btn">
    <p>ðŸ’³ Wallet & Payouts</p>
  </a>

  <a href="profile.html" class="nav-btn">
    <p>ðŸ‘¤ Profile</p>
  </a>

  <a href="analytics.html" class="nav-btn">
    <p>ðŸ“ˆ Analytics</p>
  </a>

</div>

<script>
/* -------------------------
   Check Login Session
--------------------------*/
const user = JSON.parse(localStorage.getItem("zepMerchant"));
if (!user || !user.wallet) {
  window.location.href = "login.html";
}

/* Display Wallet */
document.getElementById("walletDisplay").textContent =
  user.wallet.slice(0, 6) + "..." + user.wallet.slice(-4);


/* -------------------------
   MOCK ZAC Balance (MVP)
   Replace with contract read later
--------------------------*/
async function loadZACBalance() {
  document.getElementById("zacBalance").textContent = "Loading...";

  // ðŸ’¡ Temporary balance simulation
  let fakeBalance = Math.floor(Math.random() * 5000) / 10;
  document.getElementById("zacBalance").textContent = fakeBalance + " ZAC";
}
loadZACBalance();


/* -------------------------
   Real-Time Wallet Listener
--------------------------*/
if (window.ethereum) {
  window.ethereum.on("accountsChanged", (accounts) => {
    if (accounts.length === 0) {
      logout();
    } else {
      const updatedWallet = accounts[0];
      localStorage.setItem("zepMerchant", JSON.stringify({
        wallet: updatedWallet,
        provider: user.provider
      }));
      location.reload();
    }
  });
}


/* -------------------------
   Logout
--------------------------*/
function logout() {
  localStorage.removeItem("zepMerchant");
  window.location.href = "login.html";
}
</script>

</body>
</html>