<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zep Swipe â€” Merchant POS</title>

<!-- Tailwind -->
<script src="https://cdn.tailwindcss.com"></script>
<!-- Ethers -->
<script src="https://cdn.jsdelivr.net/npm/ethers@6.6.0/dist/ethers.min.js"></script>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
  :root {
    --zep-blue:#00eaff;
    --zep-purple:#a65dff;
    --glass:rgba(255,255,255,0.07);
  }

  body {
    background: radial-gradient(circle at 20% 20%, #050013, #02000b, #10022b);
    color: white;
    font-family: 'Poppins', sans-serif;
    padding-bottom: 100px;
  }

  .glass {
    background: var(--glass);
    border: 1px solid rgba(255,255,255,0.18);
    backdrop-filter: blur(20px);
    border-radius: 1.2rem;
    padding: 1.5rem;
    box-shadow: 0 0 30px rgba(0,255,255,0.2);
  }

  .neon-btn {
    background: linear-gradient(90deg,var(--zep-blue),var(--zep-purple));
    padding: 14px;
    border-radius: 12px;
    font-family: Orbitron;
    font-weight: bold;
    text-shadow: 0 0 8px rgba(0,0,0,0.6);
    color: #050018;
    box-shadow: 0 0 20px rgba(0,255,255,0.4);
  }

  .footer-pos {
    position: fixed;
    bottom: 0; left:0; right:0;
    padding: 1rem;
    background: rgba(255,255,255,0.06);
    backdrop-filter: blur(15px);
    display: flex;
    justify-content: space-around;
    border-top: 1px solid rgba(255,255,255,0.14);
  }

  .footer-icon {
    width: 35px;
    filter: drop-shadow(0 0 10px rgba(0,255,255,0.6));
    transition: 0.3s;
  }

  .footer-icon:hover {
    transform: scale(1.1);
    filter: drop-shadow(0 0 20px rgba(166,93,255,0.9));
  }
</style>
</head>

<body>

<!-- HEADER -->
<div class="flex justify-between items-center mx-5 mt-5 mb-4 glass">
  <h1 class="text-xl font-orbitron bg-gradient-to-r from-cyan-400 to-purple-500 bg-clip-text text-transparent">
    Zep Swipe POS
  </h1>
  <img src="https://www.svgrepo.com/show/503029/logout.svg" onclick="logout()" class="w-7 cursor-pointer">
</div>

<!-- AMOUNT INPUT -->
<div class="glass mx-5 mb-5">
  <p class="text-cyan-300 mb-1">Enter Amount (USDT)</p>
  <input id="amount" type="number" step="0.01"
         class="w-full p-3 rounded-lg bg-black/20 border border-cyan-500/30 text-white text-xl"
         placeholder="0.00">
</div>

<!-- DISCOUNTS -->
<div class="mx-5 mb-4">
  <h2 class="text-cyan-300 mb-2">Discounts</h2>
  <div class="grid grid-cols-3 gap-3">
    <button onclick="applyDiscount(5)" class="glass py-3 text-center">5% Off</button>
    <button onclick="applyDiscount(10)" class="glass py-3 text-center">10% Off</button>
    <button onclick="applyDiscount(15)" class="glass py-3 text-center">15% Off</button>
  </div>
</div>

<!-- TIPS -->
<div class="mx-5 mb-5">
  <h2 class="text-cyan-300 mb-2">Add Tip</h2>
  <div class="grid grid-cols-3 gap-3">
    <button onclick="addTip(1)" class="glass py-3 text-center">+1</button>
    <button onclick="addTip(2)" class="glass py-3 text-center">+2</button>
    <button onclick="addTip(5)" class="glass py-3 text-center">+5</button>
  </div>
</div>

<!-- PAY BUTTON -->
<div class="mx-5 mb-5">
  <button class="neon-btn w-full py-4 text-lg" onclick="processPayment()">ðŸ’³ Charge USDT</button>
</div>

<!-- RECEIPT -->
<div id="receipt" class="glass mx-5 mb-24 hidden">
  <h2 class="text-lg font-semibold mb-2">Receipt</h2>
  <p id="receiptText" class="text-cyan-200 text-sm mb-3"></p>
  <button onclick="window.print()" class="neon-btn w-full mt-2">ðŸ§¾ Print Receipt</button>
</div>

<!-- FOOTER -->
<div class="footer-pos">

  <img src="https://www.svgrepo.com/show/488484/wallet.svg" class="footer-icon">
  <img src="https://www.svgrepo.com/show/500724/store.svg" class="footer-icon">
  <img src="https://www.svgrepo.com/show/489978/add.svg" class="footer-icon">
  <img src="https://www.svgrepo.com/show/493468/user-circle.svg" class="footer-icon">

</div>

<script>
let finalAmount = 0;

function applyDiscount(percent){
  let amt = parseFloat(document.getElementById("amount").value || 0);
  const discount = amt * (percent/100);
  finalAmount = amt - discount;
  document.getElementById("amount").value = finalAmount.toFixed(2);
}

function addTip(tip){
  let amt = parseFloat(document.getElementById("amount").value || 0);
  finalAmount = amt + tip;
  document.getElementById("amount").value = finalAmount.toFixed(2);
}

async function processPayment(){
  let amt = parseFloat(document.getElementById("amount").value);
  if(!amt || amt <= 0){
    alert("Enter a valid amount");
    return;
  }

  if (!window.ethereum){
    alert("Install MetaMask to continue.");
    return;
  }

  try {
    const provider = new ethers.BrowserProvider(window.ethereum);
    const signer = await provider.getSigner();

    const usdtABI = [
      "function transfer(address to, uint amount) returns (bool)"
    ];

    // âš ï¸ **INSERT BASE USDT CONTRACT ADDRESS HERE**
    const USDT = "0xYOUR_BASE_USDT_CONTRACT";

    // Merchant wallet receives payment
    const merchantWallet = "0xYourWalletHere";

    const contract = new ethers.Contract(USDT, usdtABI, signer);

    // Convert USDT to 6 decimals
    let amountToSend = ethers.parseUnits(amt.toString(), 6);

    let tx = await contract.transfer(merchantWallet, amountToSend);

    document.getElementById("receipt").classList.remove("hidden");
    document.getElementById("receiptText").innerText =
      `Amount Paid: ${amt} USDT\nTX Hash: ${tx.hash}`;

  } catch(err){
    console.error(err);
    alert("Payment failed.");
  }
}

function logout(){
  localStorage.removeItem("zepUser");
  window.location.href = "login.html";
}
</script>

</body>
</html>